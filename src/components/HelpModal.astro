---
import { Icon } from 'astro-icon/components'
import { Kbd } from '@/components/ui/kbd'
import { t } from '@/i18n/ui'
import { cn } from '@/lib/utils'
---

<div
  x-data="{
    isOpen: false,
    open() {
      this.isOpen = true;
      document.body.style.overflow = 'hidden';
    },
    close() {
      this.isOpen = false;
      document.body.style.overflow = '';
    },
    toggle() {
      if (this.isOpen) {
        this.close();
      } else {
        this.open();
      }
    }
  }"
  @keydown.escape.window="close()"
  @keydown.window="event.key === '?' && toggle()"
>
  <button
    @click="toggle()"
    class={cn(
      `
        flex items-center gap-2 rounded p-2 text-sm transition-all outline-none
        hover:bg-muted hover:underline
        focus:bg-muted focus:underline
        focus-visible:ring-1 focus-visible:ring-ring/50 focus-visible:outline-1
      `,
    )}
    aria-label="Keyboard shortcuts"
  >
    <Icon name="mdi:keyboard" class="size-4" />
    <span class="hidden md:inline">{t('navbar.shortcuts')}</span>
    <Kbd className="hidden md:inline-flex">?</Kbd>
  </button>

  <div
    x-show="isOpen"
    x-cloak
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0 translate-y-2"
    x-transition:enter-end="opacity-100 translate-y-0"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100 translate-y-0"
    x-transition:leave-end="opacity-0 translate-y-2"
    @click.away="close()"
    class={cn(
      `
        fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4
        backdrop-blur-sm
      `,
    )}
    aria-modal="true"
    role="dialog"
  >
    <div
      x-data="{
        init() {
          this.$el.focus();
        }
      }"
      @keydown.escape.window="close()"
      class={cn(
        `
          w-full max-w-lg rounded-lg bg-background p-6 shadow-lg outline-none
          focus-visible:ring-2 focus-visible:ring-ring
        `,
      )}
      tabindex="-1"
    >
      <div class="mb-4 flex items-center justify-between">
        <h2 class="text-2xl font-bold">{t('navbar.shortcutsTitle')}</h2>
        <button
          @click="close()"
          class="rounded p-1 hover:bg-muted"
          aria-label="Close"
        >
          <Icon name="dinkie-icons:black-cross-square" class="size-6" />
        </button>
      </div>

      <div class="space-y-4">
        <div>
          <h3 class="mb-2 text-sm font-semibold text-muted-foreground">
            {t('navbar.navigationShortcuts')}
          </h3>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span>{t('nav.home')}</span>
              <Kbd>1</Kbd>
            </div>
            <div class="flex justify-between">
              <span>{t('nav.blog')}</span>
              <Kbd>2</Kbd>
            </div>
            <div class="flex justify-between">
              <span>{t('nav.credits')}</span>
              <Kbd>3</Kbd>
            </div>
            <div class="flex justify-between">
              <span>{t('nav.language')}</span>
              <Kbd>4</Kbd>
            </div>
          </div>
        </div>

        <!-- <div> -->
        <!--   <h3 class="mb-2 text-sm font-semibold text-muted-foreground"> -->
        <!--     {t('navbar.blogNavigation')} -->
        <!--   </h3> -->
        <!--   <div class="space-y-2"> -->
        <!--     <div class="flex justify-between"> -->
        <!--       <span>{t('navbar.previousPost')}</span> -->
        <!--       <Kbd>[</Kbd> -->
        <!--     </div> -->
        <!--     <div class="flex justify-between"> -->
        <!--       <span>{t('navbar.nextPost')}</span> -->
        <!--       <Kbd>]</Kbd> -->
        <!--     </div> -->
        <!--   </div> -->
        <!-- </div> -->

        <div>
          <h3 class="mb-2 text-sm font-semibold text-muted-foreground">
            {t('navbar.otherShortcuts')}
          </h3>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span>{t('navbar.toggleShortcuts')}</span>
              <Kbd>?</Kbd>
            </div>
            <div class="flex justify-between">
              <span>{t('navbar.closeModal')}</span>
              <Kbd>Esc</Kbd>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
